var ri=Object.defineProperty;var St=r=>{throw TypeError(r)};var oi=(r,e,t)=>e in r?ri(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var F=(r,e,t)=>oi(r,typeof e!="symbol"?e+"":e,t),lt=(r,e,t)=>e.has(r)||St("Cannot "+t);var o=(r,e,t)=>(lt(r,e,"read from private field"),t?t.call(r):e.get(r)),w=(r,e,t)=>e.has(r)?St("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),m=(r,e,t,i)=>(lt(r,e,"write to private field"),i?i.call(r,t):e.set(r,t),t),M=(r,e,t)=>(lt(r,e,"access private method"),t);var Se=(r,e,t,i)=>({set _(n){m(r,e,n,t)},get _(){return o(r,e,i)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();function at(r){return r.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}function ht(r){return r instanceof Function&&!!r.prototype&&!!r.prototype.constructor}let li=/^[a-zA-Z$][a-zA-Z0-9_$]*$/;function pe(r){return r.match(li)?`.${r}`:`[${JSON.stringify(r)}]`}function Dt(r,e){r.loading?r.addEventListener("loaded",e,{once:!0}):e()}function ai(r){return new Promise(e=>Dt(r,e))}var se;class di extends EventTarget{constructor(){super();w(this,se,0);this.browser=!1,this.ssr=!1}enterLoading(){Se(this,se)._++,o(this,se)==1&&this.dispatchEvent(new Event("loading"))}leaveLoading(){Se(this,se)._--,o(this,se)==0&&this.dispatchEvent(new Event("loaded"))}get loading(){return o(this,se)!=0}async load(t){this.enterLoading();try{return await t()}finally{this.leaveLoading()}}untilLoaded(){return ai(this)}}se=new WeakMap;let kt;Object.defineProperty(globalThis,"coenv",{get(){return kt()}});function hi(r){kt=r}class B{constructor(e){F(this,"html");this.html=e}static areEqual(e,t){return e instanceof B&&t instanceof B&&e.html==t.html}}function Rt(r){return r instanceof Function?(...e)=>new B(r(...e)):new B(r)}class ci{constructor(e){this.value=e}}class ui{static declare(e){coenv.declareStyle(e)}}function Oe(r,e){let t="";for(let i=0;i<r.length-1;i++)t+=r[i],t+=e[i];t+=r[r.length-1],ui.declare(t)}let Te=[],dt=!1;function it(r,e){r&&(e=e??0,e!=0&&(dt=!0),Te.push({callback:r,order:e}),Te.length==1&&coenv.window.requestAnimationFrame(function(){let t=Te;dt&&(t.sort((i,n)=>n.order-i.order),dt=!1),Te=[];for(let i=t.length-1;i>=0;i--)t[i].callback()}))}function Lt(r){Te.length==0?r():it(r,Number.MAX_SAFE_INTEGER)}function fi(){return Te.length!=0}function He(){let r=[],e="",t=!0;function i(...h){for(let p=0;p<h.length;p++){let f=h[p];f.lines?r.push(...f.lines.map(u=>e+u)):Array.isArray(f)?r.push(...f.filter(u=>u!=null).map(u=>e+u)):t?r.push(...f.split(`
`).map(u=>e+u)):r.push(e+f)}}function n(){e+="  "}function s(){e=e.substring(2)}function a(){return r.join(`
`)+`
`}function d(h){i("{"),n(),h(this),s(),i("}")}return{append:i,indent:n,unindent:s,braced:d,toString:a,lines:r,enableSplit(h){t=h},get isEmpty(){return r.length==0}}}class bt{constructor(){this.code=He(),this.code.closure=this,this.functions=[],this.locals=[],this.prologs=[],this.epilogs=[]}get isEmpty(){return this.code.isEmpty&&this.locals.length==0&&this.functions.every(e=>e.code.isEmpty)&&this.prologs.every(e=>e.isEmpty)&&this.epilogs.every(e=>e.isEmpty)}addProlog(){let e=He();return this.prologs.push(e),e}addEpilog(){let e=He();return this.epilogs.push(e),e}addLocal(e,t){this.locals.push({name:e,init:t})}addFunction(e,t){t||(t=[]);let i={name:e,args:t,code:new bt};return this.functions.push(i),i.code}getFunction(e){var t;return(t=this.functions.find(i=>i.name==e))==null?void 0:t.code}toString(){let e=He();return this.appendTo(e),e.toString()}appendTo(e){this.locals.length>0&&e.append(`let ${this.locals.map(t=>t.init?`${t.name} = ${t.init}`:t.name).join(", ")};`);for(let t of this.prologs)e.append(t);e.append(this.code);for(let t of this.functions)e.append(`function ${t.name}(${t.args.join(", ")})`),e.append("{"),e.indent(),t.code.appendTo(e),e.unindent(),e.append("}");for(let t of this.epilogs)e.append(t)}}function Xe(r){return r==null?"":(""+r).replace(/["'&<>]/g,function(e){switch(e){case'"':return"&quot;";case"&":return"&amp;";case"'":return"&#39;";case"<":return"&lt;";case">":return"&gt;"}})}function pi(r){let e,t,i=r.event??"input",n,s,a,d,h,p=r.parse??(c=>c),f=r.format??(c=>c);if(typeof r=="string"&&(r={prop:r}),r.get&&r.set)n=()=>r.get(t.model,t),s=c=>r.set(t.model,c,t);else if(typeof r.prop=="string"){let C=function(){let D=c();for(let E=0;E<v.length;E++)D=D[v[E]];return D};var A=C;let c;r.target instanceof Function?c=()=>r.target(t.model,t):r.target?c=()=>r.target:c=()=>t.model;let v=r.prop.split("."),L=v.pop();n=()=>C()[L],s=D=>C()[L]=D}else throw new Error("Invalid input binding");function u(c){var L;let v=d(e[h]);v!==void 0&&(v=p(v)),v!==void 0&&s(v),(L=r.on_change)==null||L.call(r,t.model,c)}function S(){let c=f(n());c!==void 0&&(c=a(c)),c!==void 0&&(e[h]=c)}function y(c,v){if(e=c,t=v,h="value",a=L=>L,d=L=>L,e.tagName=="INPUT"){let L=e.getAttribute("type").toLowerCase();L=="checkbox"?(h="checked",d=C=>!!C):L=="radio"&&(h="checked",d=C=>C?e.getAttribute("value"):void 0,a=C=>e.getAttribute("value")==C?!0:void 0)}else e.tagName=="SELECT"&&e.hasAttribute("multiple")&&(h="selectedOptions",d=L=>Array.from(L).map(C=>C.value),a=L=>{Array.from(e.options).forEach(C=>{C.selected=L.indexOf(C.value)>=0})});e.addEventListener(i,u)}function k(){e.removeEventListener(i,u),e=null}return{create:y,update:S,destroy:k}}class Me{static rawText(e){return e instanceof B?e.html:Xe(e)}static renderToString(e){let t="";return e({write:function(i){t+=i}}),t}static renderComponentToString(e){let t="";return e.render({write:function(i){t+=i}}),t}static rawStyle(e){let t;return e instanceof B?t=e.html:t=Xe(e),t=t.trim(),t.endsWith(";")||(t+=";"),t}static rawNamedStyle(e,t){if(!t)return"";let i;return t instanceof B?i=t.html:i=Xe(t),i=i.trim(),i+=";",`${e}:${i}`}static createTextNode(e){if(e instanceof B){let t=document.createElement("SPAN");return t.innerHTML=e.html,t}else return document.createTextNode(e)}static setElementAttribute(e,t,i){i===void 0?e.removeAttribute(t):e.setAttribute(t,i)}static setElementText(e,t){t instanceof B?e.innerHTML=t.html:e.textContent=t}static setNodeText(e,t){if(t instanceof B){if(e.nodeType==1)return e.innerHTML=t.html,e;let i=document.createElement("SPAN");return i.innerHTML=t.html,e.replaceWith(i),i}else{if(e.nodeType==3)return e.nodeValue=t,e;let i=document.createTextNode(t);return e.replaceWith(i),i}}static setNodeClass(e,t,i){i?e.classList.add(t):e.classList.remove(t)}static setNodeStyle(e,t,i){i==null?e.style.removeProperty(t):e.style[t]=i}static boolClassMgr(e,t,i,n){let s=null,a;return function(){let h=n(e.model,e);h!=a&&(a=h,n.withTransition&&t.isConnected?(s==null||s.finish(),s=n.withTransition(e),h?(s.enterNodes([t]),s.onWillEnter(()=>t.classList.add(i))):(s.leaveNodes([t]),s.onDidLeave(()=>t.classList.remove(i))),s.start()):Me.setNodeClass(t,i,h))}}static setNodeDisplay(e,t,i){if(t===!0){i===null?e.style.removeProperty("display"):i!==void 0&&e.style.display!=i&&(e.style.display=i);return}else if(t===!1||t===null||t===void 0){let n=e.style.display;return e.style.display!="none"&&(e.style.display="none"),n??null}else if(typeof t=="string"){let n=e.style.display;return e.style.display!=t&&(e.style.display=t),n??null}}static displayMgr(e,t,i){let n=null,s,a;return function(){let h=i(e.model,e);if(h!=s){if(s=h,coenv.browser&&i.withTransition&&t.isConnected){n==null||n.finish();let p=window.getComputedStyle(t).getPropertyValue("display"),f;if(h===!0?f=a:h===!1||h===null||h===void 0?f="none":f=h,p=="none"!=(f=="none")){n=i.withTransition(e),f!="none"?(n.enterNodes([t]),n.onWillEnter(()=>a=Me.setNodeDisplay(t,h,a))):(n.leaveNodes([t]),n.onDidLeave(()=>a=Me.setNodeDisplay(t,h,a))),n.start();return}}a=Me.setNodeDisplay(t,h,a)}}}static replaceMany(e,t){var i;if((i=e==null?void 0:e[0])!=null&&i.parentNode){e[0].replaceWith(...t);for(let n=1;n<e.length;n++)e[n].remove()}}static addEventListener(e,t,i,n){function s(a){return n(e(),a)}return t.addEventListener(i,s),function(){t.removeEventListener(i,s)}}static input(){return pi(...arguments)}}class Ie{static register(e){this.plugins.push(e)}static transform(e){for(let t of this.plugins)t.transform&&(e=t.transform(e));return e}static transformGroup(e){for(let t of this.plugins)t.transformGroup&&(e=t.transformGroup(e));return e}}F(Ie,"plugins",[]);function mi(r){let e=r.match(/\s*([^ \t.#]*)/);if(!e)return{};r=r.substring(e[0].length);let t=[],i={type:e[1]};for(let n of r.matchAll(/\s*([.#]?)([^ \t=.#]+)(?:\s*=\s*(\'[^']+\'|\S+))?/g)){if(!n[3]){if(n[1]=="."){t.push(n[2]);continue}else if(n[1]=="#"){i.id=n[2];continue}}let s=n[2];s=="type"&&(s="attr_type");let a=n[3]??n[2];(a.startsWith("'")&&a.endsWith("'")||a.startsWith('"')&&a.endsWith('"'))&&(a=a.substring(1,a.length-1)),i[s]=a}return t.length>0&&(i.class=t.join(" ")),i}class ee{constructor(e){if(e.$node&&(e=e.$node),Array.isArray(e)?e={$:e}:typeof e=="object"&&!(e instanceof B)&&(e=Object.assign({},e)),typeof e.type=="string"&&e.type[0]!="#"&&Object.assign(e,mi(e.type)),e=Ie.transform(e),ht(e)&&(e={type:e}),this.template=e,ht(e.type))e.type.integrate?this.kind="integrated":this.kind="component";else if(typeof e=="string")this.kind="text";else if(e instanceof B){if(this.kind="html",this.html=e.html,coenv.document){let t=coenv.document.createElement("div");t.innerHTML=e.html,this.nodes=[...t.childNodes],this.nodes.forEach(i=>i.remove())}}else e instanceof Function?this.kind="dynamic_text":e.type==="#comment"?this.kind="comment":e.type===void 0?this.kind="fragment":this.kind="element";if(this.kind==="integrated"&&(e.$&&!e.content&&(e.content=e.$,delete e.$),this.integrated=this.template.type.integrate(this.template)),this.kind=="element"&&e.$&&!e.text&&(typeof e.$=="string"||e.$ instanceof B)&&(e.text=e.$,delete e.$),this.kind=="element"||this.kind=="fragment")e.$&&!e.childNodes&&(e.childNodes=e.$,delete e.$),e.childNodes?(Array.isArray(e.childNodes)?e.childNodes=e.childNodes.flat():e.childNodes=[e.childNodes],e.childNodes=e.childNodes.map(t=>t.$node??t),this.childNodes=Ie.transformGroup(e.childNodes).map(t=>new ee(t))):this.childNodes=[];else if(this.isComponent)e.$&&!e.content&&(e.content=e.$,delete e.$);else if(e.childNodes)throw new Error("childNodes only supported on element and fragment nodes")}get isSingleRoot(){return this.isFragment?this.childNodes.length==1&&this.childNodes[0].isSingleRoot:this.isComponent?this.template.type.isSingleRoot:this.isIntegrated?this.integrated.isSingleRoot:this.kind=="html"?this.nodes.length==1:!0}get isComponent(){return this.kind==="component"}get isFragment(){return this.kind==="fragment"}get isIntegrated(){return this.kind==="integrated"}*enumLocalNodes(){if(this.isFragment||(yield this),this.childNodes)for(let e=0;e<this.childNodes.length;e++)yield*this.childNodes[e].enumLocalNodes()}spreadChildDomNodes(){return Array.from(e(this)).filter(t=>t.length>0).join(", ");function*e(t){for(let i=0;i<t.childNodes.length;i++)yield t.childNodes[i].spreadDomNodes()}}spreadDomNodes(){return Array.from(this.enumAllNodes()).join(", ")}*enumAllNodes(){switch(this.kind){case"fragment":for(let e=0;e<this.childNodes.length;e++)yield*this.childNodes[e].enumAllNodes();break;case"component":case"integrated":this.isSingleRoot?yield`${this.name}.rootNode`:yield`...${this.name}.rootNodes`;break;case"html":this.nodes.length>0&&(this.nodes.length>1?yield`...${this.name}`:yield`${this.name}`);break;default:yield this.name}}}let Ft={enterNodes:function(){},leaveNodes:function(){},onWillEnter:function(r){r()},onDidLeave:function(r){r()},start:function(){},finish:function(){}};var W,j,X,O,Ce,De,Ue,We,K,Ve,Y,Bt,re;const Qe=class Qe{constructor(e){w(this,K);w(this,W);w(this,j);w(this,X);w(this,O);w(this,Ce);w(this,De);w(this,Ue);w(this,We);w(this,Y,!0);w(this,re);var t,i;m(this,W,e.context),m(this,Ue,e.nodes[1]),m(this,Ce,(t=coenv.document)==null?void 0:t.createTextNode("")),m(this,De,(i=coenv.document)==null?void 0:i.createTextNode("")),m(this,Y,e.data.ownsContent??!0),e.nodes[0]?this.content=e.nodes[0]():this.content=e.data.content}static integrate(e){let t=null;e.content&&typeof e.content=="object"&&(t=e.content,delete e.content);let i={isSingleRoot:!1,data:{ownsContent:e.ownsContent??!0,content:e.content},nodes:[t?new ee(t):null,e.placeholder?new ee(e.placeholder):null]};return delete e.content,delete e.placeholder,delete e.ownsContent,i}static transform(e){return e instanceof Function&&!ht(e)?{type:Qe,content:e}:(e.type=="embed-slot"&&(e.type=Qe),e)}get rootNodes(){return[o(this,Ce),...o(this,K,Ve),o(this,De)]}get isSingleRoot(){return!1}get ownsContent(){return o(this,Y)}set ownsContent(e){m(this,Y,e)}get content(){return o(this,j)}set content(e){m(this,j,e),o(this,j)instanceof Function?this.replaceContent(o(this,j).call(o(this,W).model,o(this,W).model,o(this,W))):this.replaceContent(o(this,j))}update(){var e,t;o(this,j)instanceof Function&&this.replaceContent(o(this,j).call(o(this,W).model,o(this,W).model,o(this,W))),o(this,X)||(t=(e=o(this,O))==null?void 0:e.update)==null||t.call(e)}bind(){var e,t;o(this,X)||(t=(e=o(this,O))==null?void 0:e.bind)==null||t.call(e)}unbind(){var e,t;o(this,X)||(t=(e=o(this,O))==null?void 0:e.unbind)==null||t.call(e)}get isAttached(){}setMounted(e){var t,i;m(this,re,e),(i=(t=o(this,O))==null?void 0:t.setMounted)==null||i.call(t,e)}replaceContent(e){var s,a,d,h,p,f,u,S;if((o(this,X)===e||B.areEqual(o(this,X),e))&&(e||o(this,O)))return;let t=o(this,O),i=[...o(this,K,Ve)];m(this,X,e);let n;if(!e)n=((s=o(this,Ue))==null?void 0:s.call(this,o(this,W)))??null;else if(e.rootNodes)n=e;else if(e instanceof B){let y=coenv.document.createElement("span");y.innerHTML=e.html,n=[...y.childNodes],n.forEach(k=>k.remove())}else if(typeof e=="string")n=[coenv.document.createTextNode(e)];else if(Array.isArray(e))n=e;else if(e.nodeType!==void 0)n=[e];else if(e.render)n=e;else throw new Error("Embed slot requires component, array of HTML nodes or a single HTML node");if(m(this,O,n),o(this,K,Bt)){(a=o(this,We))==null||a.finish();let y;o(this,re)&&(y=(h=(d=o(this,j))==null?void 0:d.withTransition)==null?void 0:h.call(d,o(this,W))),y||(y=Ft),m(this,We,y),y.enterNodes(o(this,K,Ve)),y.leaveNodes(i),y.onWillEnter(()=>{var k,A;o(this,De).before(...o(this,K,Ve)),o(this,re)&&((A=(k=o(this,O))==null?void 0:k.setMounted)==null||A.call(k,!0))}),y.onDidLeave(()=>{var k,A;i.forEach(c=>c.remove()),o(this,re)&&((k=t==null?void 0:t.setMounted)==null||k.call(t,!1)),o(this,Y)&&((A=t==null?void 0:t.destroy)==null||A.call(t))}),y.start()}else o(this,re)&&((p=t==null?void 0:t.setMounted)==null||p.call(t,!1),(u=(f=o(this,O))==null?void 0:f.setMounted)==null||u.call(f,!0)),o(this,Y)&&((S=t==null?void 0:t.destroy)==null||S.call(t))}destroy(){var e,t;o(this,Y)&&((t=(e=o(this,O))==null?void 0:e.destroy)==null||t.call(e))}};W=new WeakMap,j=new WeakMap,X=new WeakMap,O=new WeakMap,Ce=new WeakMap,De=new WeakMap,Ue=new WeakMap,We=new WeakMap,K=new WeakSet,Ve=function(){var e;return((e=o(this,O))==null?void 0:e.rootNodes)??o(this,O)??[]},Y=new WeakMap,Bt=function(){var e;return((e=o(this,Ce))==null?void 0:e.parentNode)!=null},re=new WeakMap;let ct=Qe;Ie.register(ct);function gi(r,e){let t=Math.min(r.length,e.length),i=Math.max(r.length,e.length),n=0;for(;n<t&&r[n]==e[n];)n++;if(n==i)return[];if(n==r.length)return[{op:"insert",index:r.length,count:e.length-r.length}];let s=0;for(;s<t-n&&r[r.length-s-1]==e[e.length-s-1];)s++;if(s==r.length)return[{op:"insert",index:0,count:e.length-r.length}];if(n+s==r.length)return[{op:"insert",index:n,count:e.length-r.length}];if(n+s==e.length)return[{op:"delete",index:n,count:r.length-e.length}];let a=r.length-s,d=e.length-s,h=A(e,n,d),p=null,f=[],u=n,S=n;for(;u<d;){for(;u<d&&r[S]==e[u];)h.delete(e[u],u),u++,S++;let c=u,v=S;for(;S<a&&!h.has(r[S]);)S++;if(S>v){f.push({op:"delete",index:c,count:S-v});continue}for(p||(p=A(r,u,a));u<d&&!p.has(e[u]);)h.delete(e[u],u),u++;if(u>c){f.push({op:"insert",index:c,count:u-c});continue}break}if(u==d)return f;let y=0,k=new _t;for(;S<a;){let c=S;for(;S<a&&!h.has(r[S]);)S++;if(S>c){f.push({op:"delete",index:u,count:S-c});continue}for(;S<a&&h.consume(r[S])!==void 0;)k.add(r[S],y++),S++;S>c&&f.push({op:"store",index:u,count:S-c})}for(;u<d;){let c=u;for(;u<d&&!k.has(e[u]);)u++;if(u>c){f.push({op:"insert",index:c,count:u-c});continue}let v={op:"restore",index:u,count:0};for(f.push(v);u<d;){let L=k.consume(e[u]);if(L===void 0)break;v.count==0?(v.storeIndex=L,v.count=1):v.storeIndex+v.count==L?v.count++:(v={op:"restore",index:u,storeIndex:L,count:1},f.push(v)),u++}}return f;function A(c,v,L){let C=new _t;for(let D=v;D<L;D++)C.add(c[D],D);return C}}var oe;class _t{constructor(){w(this,oe,new Map)}add(e,t){let i=o(this,oe).get(e);i?i.push(t):o(this,oe).set(e,[t])}delete(e,t){let i=o(this,oe).get(e);if(i){let n=i.indexOf(t);if(n>=0){i.splice(n,1);return}}throw new Error("key/value pair not found")}consume(e){let t=o(this,oe).get(e);if(!(!t||t.length==0))return t.shift()}has(e){return o(this,oe).has(e)}}oe=new WeakMap;var ke,Z,J,$,Pt,ft,ve,we,Je,$e,ge,It,pt,Ot,mt,Vt,gt,qt,yt,Le;const Ke=class Ke{constructor(e){w(this,$);w(this,ke);w(this,Z);w(this,J,!1);w(this,ve);w(this,we);w(this,Je);w(this,$e);var t,i;this.itemConstructor=e.data.itemConstructor,this.outer=e.context,this.items=e.data.template.items,this.condition=e.data.template.condition,this.itemKey=e.data.template.itemKey,this.emptyConstructor=e.nodes.length?e.nodes[0]:null,this.itemDoms=[],m(this,ke,(t=coenv.document)==null?void 0:t.createComment(" enter foreach block ")),m(this,Z,(i=coenv.document)==null?void 0:i.createComment(" leave foreach block ")),this.itemConstructor.isSingleRoot?(m(this,ve,M(this,$,Vt)),m(this,Je,M(this,$,qt)),m(this,we,M(this,$,gt)),m(this,$e,M(this,$,yt))):(m(this,ve,M(this,$,It)),m(this,Je,M(this,$,Ot)),m(this,we,M(this,$,pt)),m(this,$e,M(this,$,mt)))}static integrate(e){let t=e.template,i={template:{items:e.items,condition:e.condition,itemKey:e.itemKey}},n;return e.empty&&(n=[new ee(e.empty)]),delete e.template,delete e.items,delete e.condition,delete e.itemKey,delete e.empty,{isSingleRoot:!1,data:i,nodes:n,compile:s=>{i.itemConstructor=s.compileTemplate(t,s)}}}static transform(e){if(e.foreach===void 0)return e;let t;return e.foreach instanceof Function||Array.isArray(e.foreach)?(t={type:Ke,template:e,items:e.foreach},delete e.foreach):(t=Object.assign({},e.foreach,{type:Ke,template:e}),delete e.foreach),t}get rootNodes(){let e=this.emptyDom?this.emptyDom.rootNodes:[];if(this.itemConstructor.isSingleRoot)return[o(this,ke),...this.itemDoms.map(t=>t.rootNode),...e,o(this,Z)];{let t=[o(this,ke)];for(let i=0;i<this.itemDoms.length;i++)t.push(...this.itemDoms[i].rootNodes);return t.push(...e),t.push(o(this,Z)),t}}setMounted(e){m(this,J,e),me(this.itemDoms,e)}update(){let e;this.items instanceof Function?e=this.items.call(this.outer.model,this.outer.model,this.outer):e=this.items,e=e??[];let t={outer:this.outer},i=null;if(this.condition&&(e=e.filter(n=>(t.model=n,this.condition.call(n,n,t)))),this.itemKey&&(i=e.map(n=>(t.model=n,this.itemKey.call(n,n,t)))),!this.itemsLoaded){this.itemsLoaded=!0,o(this,ve).call(this,e,i,0,0,e.length),M(this,$,ft).call(this);return}M(this,$,Pt).call(this,0,this.itemDoms.length,e,i)}bind(){var e,t;(t=(e=this.emptyDom)==null?void 0:e.bind)==null||t.call(e)}unbind(){var e,t;(t=(e=this.emptyDom)==null?void 0:e.unbind)==null||t.call(e)}destroy(){Ze(this.itemDoms),this.itemDoms=null}};ke=new WeakMap,Z=new WeakMap,J=new WeakMap,$=new WeakSet,Pt=function(e,t,i,n){let s=e+t,a;e==0&&t==this.itemDoms.length?a=this.itemDoms:a=this.itemDoms.slice(e,s);let d;if(n?d=gi(a.map(c=>c.context.key),n):i.length>a.length?d=[{op:"insert",index:a.length,count:i.length-a.length}]:i.length<a.length?d=[{op:"delete",index:i.length,count:a.length-i.length}]:d=[],d.length==0){M(this,$,Le).call(this,i,n,e,0,t);return}let h=[],p=[],f={insert:S,delete:y,store:k,restore:A},u=0;for(let c of d)c.index>u&&(M(this,$,Le).call(this,i,n,e+u,u,c.index-u),u=c.index),f[c.op].call(this,c);u<i.length&&M(this,$,Le).call(this,i,n,e+u,u,i.length-u),Ze(p),M(this,$,ft).call(this);function S(c){u+=c.count;let v=Math.min(p.length,c.count);if(v){let L=p.splice(0,v);o(this,we).call(this,c.index+e,L),M(this,$,Le).call(this,i,n,c.index+e,c.index,v),o(this,J)&&me(L,!0)}v<c.count&&o(this,ve).call(this,i,n,c.index+e+v,c.index+v,c.count-v)}function y(c){let v=o(this,$e).call(this,c.index+e,c.count);o(this,J)&&me(v,!1),p.push(...v)}function k(c){h.push(...o(this,$e).call(this,c.index+e,c.count))}function A(c){u+=c.count,o(this,we).call(this,c.index+e,h.slice(c.storeIndex,c.storeIndex+c.count)),M(this,$,Le).call(this,i,n,c.index+e,c.index,c.count)}},ft=function(){if(this.itemDoms.length==0)!this.emptyDom&&this.emptyConstructor&&(this.emptyDom=this.emptyConstructor(),o(this,$,ge)&&o(this,Z).before(...this.emptyDom.rootNodes),o(this,J)&&this.emptyDom.setMounted(!0)),this.emptyDom&&this.emptyDom.update();else if(this.emptyDom){if(o(this,$,ge))for(var e of this.emptyDom.rootNodes)e.remove();o(this,J)&&this.emptyDom.setMounted(!1),this.emptyDom.destroy(),this.emptyDom=null}},ve=new WeakMap,we=new WeakMap,Je=new WeakMap,$e=new WeakMap,ge=function(){var e;return((e=o(this,Z))==null?void 0:e.parentNode)!=null},It=function(e,t,i,n,s){let a=[];for(let d=0;d<s;d++){let h={outer:this.outer,model:e[n+d],key:t==null?void 0:t[n+d],index:i+d};a.push(this.itemConstructor(h))}M(this,$,pt).call(this,i,a),o(this,J)&&me(a,!0)},pt=function(e,t){if(this.itemDoms.splice(e,0,...t),o(this,$,ge)){let i=[];t.forEach(s=>i.push(...s.rootNodes));let n;e+t.length<this.itemDoms.length?n=this.itemDoms[e+t.length].rootNodes[0]:n=o(this,Z),n.before(...i)}},Ot=function(e,t){let i=M(this,$,mt).call(this,e,t);o(this,J)&&me(i,!1),Ze(i)},mt=function(e,t){if(o(this,$,ge))for(let i=0;i<t;i++){let n=this.itemDoms[e+i].rootNodes;for(let s=0;s<n.length;s++)n[s].remove()}return this.itemDoms.splice(e,t)},Vt=function(e,t,i,n,s){let a=[];for(let d=0;d<s;d++){let h={outer:this.outer,model:e[n+d],key:t==null?void 0:t[n+d],index:i+d};a.push(this.itemConstructor(h))}M(this,$,gt).call(this,i,a),o(this,J)&&me(a,!0)},gt=function(e,t){if(this.itemDoms.splice(e,0,...t),o(this,$,ge)){let i=t.map(s=>s.rootNode),n;e+t.length<this.itemDoms.length?n=this.itemDoms[e+t.length].rootNode:n=o(this,Z),n.before(...i)}},qt=function(e,t){let i=M(this,$,yt).call(this,e,t);o(this,J)&&me(i,!1),Ze(i)},yt=function(e,t){if(o(this,$,ge))for(let i=0;i<t;i++)this.itemDoms[e+i].rootNode.remove();return this.itemDoms.splice(e,t)},Le=function(e,t,i,n,s){for(let a=0;a<s;a++){let d=this.itemDoms[i+a];d.context.key=t==null?void 0:t[n+a],d.context.index=i+a,d.context.model=e[n+a],d.rebind(),d.update()}};let ut=Ke;function Ze(r){for(let e=r.length-1;e>=0;e--)r[e].destroy()}function me(r,e){for(let t=r.length-1;t>=0;t--)r[t].setMounted(e)}Ie.register(ut);function Tt(r){let e=function(){var i;let t=(i=coenv.document)==null?void 0:i.createComment(r);return{get rootNode(){return t},get rootNodes(){return[t]},get isSingleRoot(){return!0},setMounted(n){},destroy(){},update(){}}};return e.isSingleRoot=!0,e}var je,le;const ze=class ze{constructor(e){w(this,je);w(this,le,!1);var t;this.isSingleRoot=e.data.isSingleRoot,this.branches=e.data.branches,this.key=e.data.key,this.branch_constructors=[],this.context=e.context;for(let i of this.branches)i.nodeIndex!==void 0?this.branch_constructors.push(e.nodes[i.nodeIndex]):this.branch_constructors.push(Tt(" IfBlock placeholder "));this.activeBranchIndex=-1,this.activeKey=void 0,this.activeBranch=Tt(" IfBlock placeholder ")(),this.isSingleRoot||(this.headSentinal=(t=coenv.document)==null?void 0:t.createComment(" if "))}static integrate(e){let t=[],i=e.key;delete e.key;let n=[],s=!1,a=!0;for(let d=0;d<e.branches.length;d++){let h=e.branches[d],p={};if(t.push(p),h.condition instanceof Function?(p.condition=h.condition,s=!1):h.condition!==void 0?(p.condition=()=>h.condition,s=!!h.condition):(p.condition=()=>!0,s=!0),h.template!==void 0){let f=new ee(h.template);f.isSingleRoot||(a=!1),p.nodeIndex=n.length,n.push(f)}}return delete e.branches,s||t.push({condition:()=>!0}),{isSingleRoot:a,nodes:n,data:{key:i,branches:t,isSingleRoot:a}}}static transform(e){if(e.key!==void 0){let t=e.key;if(!(t instanceof Function))throw new Error("`key` is not a function");return delete e.key,{type:ze,key:t,branches:[{template:this.transform(e),condition:!0}]}}if(e.if!==void 0){let t={type:ze,branches:[{template:e,condition:e.if}]};return delete e.if,t}return e}static transformGroup(e){let t=null,i=!1;for(let n=0;n<e.length;n++){let s=e[n];if(s.if)i||(e=[...e],i=!0),s=Object.assign({},s),t={type:ze,branches:[{condition:s.if,template:s}]},delete s.if,e.splice(n,1,t);else if(s.elseif){if(!t)throw new Error("template has 'elseif' without a preceeding condition");s=Object.assign({},s),t.branches.push({condition:s.elseif,template:s}),delete s.elseif,e.splice(n,1),n--}else if(s.else!==void 0){if(!t)throw new Error("template has 'else' without a preceeding condition");s=Object.assign({},s),t.branches.push({condition:!0,template:s}),delete s.else,t=null,e.splice(n,1),n--}else t=null}return e}destroy(){this.activeBranch.destroy()}update(){this.switchActiveBranch(),this.activeBranch.update()}unbind(){var e,t;(t=(e=this.activeBranch).unbind)==null||t.call(e)}bind(){var e,t;(t=(e=this.activeBranch).bind)==null||t.call(e)}get isAttached(){var e;return this.isSingleRoot?((e=this.activeBranch.rootNode)==null?void 0:e.parentNode)!=null:this.headSentinal.parentNode!=null}switchActiveBranch(){var i,n,s,a,d;let e=this.resolveActiveBranch(),t=this.key?this.key.call(this.context.model,this.context.model,this.context):void 0;if(e!=this.activeBranchIndex||t!=this.activeKey){(i=o(this,je))==null||i.finish();let h=this.isAttached,p=this.activeBranch;if(this.activeBranchIndex=e,this.activeKey=t,this.activeBranch=this.branch_constructors[e](),h){let f;o(this,le)&&(this.key?f=(s=(n=this.key).withTransition)==null?void 0:s.call(n,this.context):f=(d=(a=this.branches[0].condition).withTransition)==null?void 0:d.call(a,this.context)),f||(f=Ft),m(this,je,f),f.enterNodes(this.activeBranch.rootNodes),f.leaveNodes(p.rootNodes),f.onWillEnter(()=>{this.isSingleRoot?p.rootNodes[p.rootNodes.length-1].after(this.activeBranch.rootNodes[0]):this.headSentinal.after(...this.activeBranch.rootNodes),o(this,le)&&this.activeBranch.setMounted(!0)}),f.onDidLeave(()=>{p.rootNodes.forEach(u=>u.remove()),o(this,le)&&p.setMounted(!1),p.destroy()}),f.start()}else o(this,le)&&(this.activeBranch.setMounted(!0),p.setMounted(!1),p.destroy())}}resolveActiveBranch(){for(let e=0;e<this.branches.length;e++)if(this.branches[e].condition.call(this.context.model,this.context.model,this.context))return e;throw new Error("internal error, IfBlock didn't resolve to a branch")}setMounted(e){m(this,le,e),this.activeBranch.setMounted(e)}get rootNodes(){return this.isSingleRoot?this.activeBranch.rootNodes:[this.headSentinal,...this.activeBranch.rootNodes]}get rootNode(){return this.activeBranch.rootNode}};je=new WeakMap,le=new WeakMap;let vt=ze;Ie.register(vt);function yi(r,e){let t=1,i=1,n=[],s=null,a=new ee(r),d=new Map;return{code:p(a,!0).toString(),isSingleRoot:a.isSingleRoot,refs:n};function p(f,u){let S={emit_text_node:Zt,emit_html_node:Xt,emit_dynamic_text_node:Yt,emit_comment_node:Qt,emit_fragment_node:ti,emit_element_node:ii,emit_integrated_node:Kt,emit_component_node:ei},y=new bt,k=y.addFunction("create").code,A=[],c=y.addFunction("bind").code,v=y.addFunction("update").code,L=y.addFunction("unbind").code,C=y.addFunction("setMounted",["mounted"]).code,D=y.addFunction("destroy").code,E=k.append,_=v.append,ce;u&&(ce=y.addFunction("rebind").code);let Nt=new Map;u&&(s=y,s.code.append("let model = context.model;"),s.code.append("let document = env.document;")),y.code.append("create();"),y.code.append("bind();"),y.code.append("update();"),st(f),E(A),c.closure.isEmpty||(E("bind();"),D.closure.addProlog().append("unbind();"));let ue=[];return f.isSingleRoot&&ue.push(`  get rootNode() { return ${f.spreadDomNodes()}; },`),u?(ue.push("  context,"),f==a&&d.forEach((l,g)=>ue.push(`  get ${g}() { return ${l}; },`)),y.getFunction("bind").isEmpty?ce.append("model = context.model"):(ce.append("if (model != context.model)"),ce.braced(()=>{ce.append("unbind();"),ce.append("model = context.model"),ce.append("bind();")})),ue.push("  rebind,")):(ue.push("  bind,"),ue.push("  unbind,")),y.code.append(["return { ","  update,","  destroy,","  setMounted,",`  get rootNodes() { return [ ${f.spreadDomNodes()} ]; },`,`  isSingleRoot: ${f.isSingleRoot},`,...ue,"};"]),y;function fe(l){l.template.export?s.addLocal(l.name):y.addLocal(l.name)}function Ge(){v.temp_declared||(v.temp_declared=!0,_("let temp;"))}function st(l){l.name=`n${t++}`,S[`emit_${l.kind}_node`](l)}function Zt(l){fe(l),E(`${l.name} = document.createTextNode(${JSON.stringify(l.template)});`)}function Xt(l){l.nodes.length!=0&&(fe(l),l.nodes.length==1?(E(`${l.name} = refs[${n.length}].cloneNode(true);`),n.push(l.nodes[0])):(E(`${l.name} = refs[${n.length}].map(x => x.cloneNode(true));`),n.push(l.nodes)))}function Yt(l){fe(l);let g=`p${i++}`;y.addLocal(g),E(`${l.name} = helpers.createTextNode("");`),Ge(),_(`temp = ${ie(n.length)};`),_(`if (temp !== ${g})`),_(`  ${l.name} = helpers.setNodeText(${l.name}, ${g} = ${ie(n.length)});`),n.push(l.template)}function Qt(l){if(fe(l),l.template.text instanceof Function){let g=`p${i++}`;y.addLocal(g),E(`${l.name} = document.createComment("");`),Ge(),_(`temp = ${ie(n.length)};`),_(`if (temp !== ${g})`),_(`  ${l.name}.nodeValue = ${g} = temp;`),n.push(l.template.text)}else E(`${l.name} = document.createComment(${JSON.stringify(l.template.text)});`)}function Kt(l){var x,P;(P=(x=l.integrated).compile)==null||P.call(x,e);let g=[],T=!1;if(l.integrated.nodes)for(let N=0;N<l.integrated.nodes.length;N++){let z=l.integrated.nodes[N];if(!z){g.push(null);continue}z.name=`n${t++}`;let Ee=p(z,!1);Ee.getFunction("bind").isEmpty||(T=!0);let Et=`${z.name}_constructor_${N+1}`,si=y.addFunction(Et,[]);Ee.appendTo(si.code),g.push(Et)}_(`${l.name}.update()`),T&&(c.append(`${l.name}.bind()`),L.append(`${l.name}.unbind()`));let R=-1;l.integrated.data&&(R=n.length,n.push(l.integrated.data)),fe(l),E(`${l.name} = new refs[${n.length}]({`,"  context,",`  data: ${l.integrated.data?`refs[${R}]`:"null"},`,`  nodes: [ ${g.join(", ")} ],`,"});"),n.push(l.template.type),C.append(`${l.name}.setMounted(mounted);`),D.append(`${l.name}?.destroy();`),D.append(`${l.name} = null;`);for(let N of Object.keys(l.template))if(!rt(l,N))throw new Error(`Unknown element template key: ${N}`)}function ei(l){fe(l),E(`${l.name} = new refs[${n.length}]();`),n.push(l.template.type);let g=new Set(l.template.type.slots??[]);g.size>0&&E(`${l.name}.create?.()`);let T=l.template.update==="auto",R=!1;C.append(`${l.name}.setMounted(mounted);`),D.append(`${l.name}?.destroy();`),D.append(`${l.name} = null;`);for(let x of Object.keys(l.template)){if(rt(l,x)||x=="update")continue;if(g.has(x)){if(l.template[x]===void 0)continue;let N=new ee(l.template[x]);st(N),N.isSingleRoot?E(`${l.name}${pe(x)}.content = ${N.name};`):E(`${l.name}${pe(x)}.content = [${N.spreadDomNodes()}];`);continue}let P=typeof l.template[x];if(P=="string"||P=="number"||P=="boolean")E(`${l.name}${pe(x)} = ${JSON.stringify(l.template[x])}`);else if(P==="function"){T&&!R&&(R=`${l.name}_mod`,_(`let ${R} = false;`));let N=`p${i++}`;y.addLocal(N);let z=n.length;Ge(),_(`temp = ${ie(z)};`),_(`if (temp !== ${N})`),T&&(_("{"),_(`  ${R} = true;`)),_(`  ${l.name}${pe(x)} = ${N} = temp;`),T&&_("}"),n.push(l.template[x])}else{let N=l.template[x];N instanceof ci&&(N=N.value),E(`${l.name}${pe(x)} = refs[${n.length}];`),n.push(N)}}l.template.update&&(typeof l.template.update=="function"?(_(`if (${ie(n.length)})`),_(`  ${l.name}.update();`),n.push(l.template.update)):T?R&&(_(`if (${R})`),_(`  ${l.name}.update();`)):_(`${l.name}.update();`))}function ti(l){xt(l)}function ii(l){var R;let g=e.xmlns,T=l.template.xmlns;T===void 0&&l.template.type=="svg"&&(T="http://www.w3.org/2000/svg"),T==null&&(T=e.xmlns),fe(l),T?(e.xmlns=T,E(`${l.name} = document.createElementNS(${JSON.stringify(T)}, ${JSON.stringify(l.template.type)});`)):E(`${l.name} = document.createElement(${JSON.stringify(l.template.type)});`),D.append(`${l.name} = null;`);for(let x of Object.keys(l.template)){if(rt(l,x))continue;if(x.startsWith("class_")){let N=at(x.substring(6)),z=l.template[x];if(z instanceof Function){l.bcCount||(l.bcCount=0);let Ee=`${l.name}_bc${l.bcCount++}`;y.addLocal(Ee),E(`${Ee} = helpers.boolClassMgr(context, ${l.name}, ${JSON.stringify(N)}, refs[${n.length}]);`),n.push(z),_(`${Ee}();`)}else E(`helpers.setNodeClass(${l.name}, ${JSON.stringify(N)}, ${z});`);continue}if(x.startsWith("style_")){let N=at(x.substring(6));ot(l.template[x],z=>`helpers.setNodeStyle(${l.name}, ${JSON.stringify(N)}, ${z})`);continue}if(x=="display"){if(l.template.display instanceof Function){let N=`${l.name}_dm`;y.addLocal(N),E(`${N} = helpers.displayMgr(context, ${l.name}, refs[${n.length}]);`),n.push(l.template.display),_(`${N}();`)}else E(`helpers.setNodeDisplay(${l.name}, ${JSON.stringify(l.template.display)});`);continue}if(x=="text"){l.template.text instanceof Function?ot(l.template.text,N=>`helpers.setElementText(${l.name}, ${N})`):l.template.text instanceof B&&E(`${l.name}.innerHTML = ${JSON.stringify(l.template.text.html)};`),typeof l.template.text=="string"&&E(`${l.name}.textContent = ${JSON.stringify(l.template.text)};`);continue}let P=x;x.startsWith("attr_")&&(P=P.substring(5)),e.xmlns||(P=at(P)),ot(l.template[x],N=>`helpers.setElementAttribute(${l.name}, ${JSON.stringify(P)}, ${N})`)}xt(l),(R=l.childNodes)!=null&&R.length&&E(`${l.name}.append(${l.spreadChildDomNodes()});`),e.xmlns=g}function xt(l){if(l.childNodes)for(let g=0;g<l.childNodes.length;g++)st(l.childNodes[g])}function rt(l,g){if(ni(g))return!0;if(g=="export"){if(typeof l.template.export!="string")throw new Error("'export' must be a string");if(d.has(l.template.export))throw new Error(`duplicate export name '${l.template.export}'`);return d.set(l.template.export,l.name),!0}if(g=="bind"){if(typeof l.template.bind!="string")throw new Error("'bind' must be a string");if(Nt.has(l.template.export))throw new Error(`duplicate bind name '${l.template.bind}'`);return Nt.set(l.template.bind,!0),c.append(`model${pe(l.template.bind)} = ${l.name};`),L.append(`model${pe(l.template.bind)} = null;`),!0}if(g.startsWith("on_")){let T=g.substring(3),R=l.template[g];if(typeof R=="string"){let P=R;R=(N,...z)=>N[P](...z)}if(!(R instanceof Function))throw new Error(`event handler for '${g}' is not a function`);l.listenerCount||(l.listenerCount=0),l.listenerCount++;let x=`${l.name}_ev${l.listenerCount}`;return y.addLocal(x),E(`${x} = helpers.addEventListener(() => model, ${l.name}, ${JSON.stringify(T)}, refs[${n.length}]);`),n.push(R),D.append(`${x}?.();`),D.append(`${x} = null;`),!0}if(g=="input"){let T=`${l.name}_in`;return y.addLocal(T),E(`${T} = helpers.input(refs[${n.length}])`),A.push(`${T}.create(${l.name}, context);`),n.push(l.template[g]),_(`${T}.update()`),D.append(`${T}.destroy()`),!0}return g=="debug_create"?(typeof l.template[g]=="function"?(E(`if (${ie(n.length)})`),E("  debugger;"),n.push(l.template[g])):l.template[g]&&E("debugger;"),!0):g=="debug_update"?(typeof l.template[g]=="function"?(_(`if (${ie(n.length)})`),_("  debugger;"),n.push(l.template[g])):l.template[g]&&_("debugger;"),!0):g=="debug_render"}function ni(l){return l=="type"||l=="childNodes"||l=="xmlns"}function ie(l){return`refs[${l}].call(model, model, context)`}function ot(l,g){if(l instanceof Function){let T=`p${i++}`;y.addLocal(T),g(),Ge(),_(`temp = ${ie(n.length)};`),_(`if (temp !== ${T})`),_(`  ${g(T+" = temp")};`),n.push(l)}else E(g(JSON.stringify(l)))}}}let vi=1;function At(r,e){e||(e={});let t=Object.assign({},e,{compileTemplate:At}),i=yi(r,t),n=new Function("env","refs","helpers","context",i.code),s=function(a){return a||(a={}),a.$instanceId=vi++,n(coenv,i.refs,Me,a??{})};return s.isSingleRoot=i.isSingleRoot,s}var V,Re,be,ae,U,Ne;const ne=class ne extends EventTarget{constructor(){super();w(this,V);w(this,Re,!1);w(this,be,null);w(this,ae,0);w(this,U);w(this,Ne,!1);this.update=this.update.bind(this),this.invalidate=this.invalidate.bind(this)}static get domTreeConstructor(){return this._domTreeConstructor||(this._domTreeConstructor=this.onProvideDomTreeConstructor()),this._domTreeConstructor}static onProvideDomTreeConstructor(){try{return this._compiling=this.onProvideTemplate(),At(this._compiling)}finally{delete this._compiling}}static onProvideTemplate(){return this.template}static get isSingleRoot(){return this._compiling?new ee(this._compiling).isSingleRoot:this.domTreeConstructor.isSingleRoot}create(){o(this,V)||m(this,V,new this.constructor.domTreeConstructor({model:this}))}get created(){return o(this,V)!=null}get domTree(){return o(this,V)||this.create(),o(this,V)}get isSingleRoot(){return this.domTree.isSingleRoot}get rootNode(){if(!this.isSingleRoot)throw new Error("rootNode property can't be used on multi-root template");return this.domTree.rootNode}get rootNodes(){return this.domTree.rootNodes}get invalid(){return o(this,Re)}invalidate(){o(this,V)&&(this.invalid||(m(this,Re,!0),ne.invalidateWorker(this)))}validate(){this.invalid&&this.update()}static invalidateWorker(t){this._invalidComponents.push(t),this._invalidComponents.length==1&&it(()=>{for(let i=0;i<this._invalidComponents.length;i++)this._invalidComponents[i].validate();this._invalidComponents=[]},ne.nextFrameOrder)}update(){o(this,V)&&(m(this,Re,!1),this.domTree.update())}get loadError(){return o(this,be)}set loadError(t){m(this,be,t),this.invalidate()}get loading(){return o(this,ae)!=0}async load(t,i){if(i){let n=await t();return this.invalidate(),n}Se(this,ae)._++,o(this,ae)==1&&(m(this,be,null),this.invalidate(),coenv.enterLoading(),this.dispatchEvent(new Event("loading")));try{return await t()}catch(n){m(this,be,n)}finally{Se(this,ae)._--,o(this,ae)==0&&(this.invalidate(),this.dispatchEvent(new Event("loaded")),coenv.leaveLoading())}}destroy(){o(this,V)&&(o(this,V).destroy(),m(this,V,null))}onMount(){}onUnmount(){}listen(t,i,n){!t||!i||(n||(n=this.invalidate),o(this,U)||m(this,U,[]),o(this,U).push({target:t,event:i,handler:n}),o(this,Ne)&&t.addEventListener(i,n))}unlisten(t,i,n){if(!t||!i||!o(this,U))return;let s=o(this,U).findIndex(a=>a.target==t&&a.event==i&&a.handler==n);s>=0&&(o(this,U).splice(s,1),o(this,Ne)&&t.removeEventListener(i,n))}get mounted(){return o(this,Ne)}setMounted(t){var n;(n=o(this,V))==null||n.setMounted(t),m(this,Ne,t);let i=!1;t&&o(this,U)&&(o(this,U).forEach(s=>s.target.addEventListener(s.event,s.handler)),i=o(this,U).length>0&&o(this,V)),t?this.onMount():this.onUnmount(),i&&this.invalidate(),!t&&o(this,U)&&o(this,U).forEach(s=>s.target.removeEventListener(s.event,s.handler))}mount(t){coenv.mount(this,t)}unmount(){coenv.unmount(this)}};V=new WeakMap,Re=new WeakMap,be=new WeakMap,ae=new WeakMap,U=new WeakMap,Ne=new WeakMap,F(ne,"_domTreeConstructor"),F(ne,"nextFrameOrder",-100),F(ne,"_invalidComponents",[]),F(ne,"template",{});let te=ne;class wi{constructor(e){this.$node={type:e}}append(...e){e=e.flat(1e3).map(t=>t.$node??t),this.$node.$?this.$node.$.push(...e):this.$node.$=[...e]}attr(e,t){if((e=="class"||e=="style")&&arguments.length>2?(e=`${e}_${t}`,t=arguments[2]):e=="on"&&arguments.length>2?(e=`on_${t}`,t=arguments[2]):e=="type"&&(e="attr_type"),this.$node[e]!==void 0)throw new Error(`duplicate attribute: ${e}`);this.$node[e]=t}}let $i={get:function(r,e){if(e!="bind"&&e!="name"){let t=Reflect.get(r,e);if(t!==void 0)return t}return(...t)=>(Reflect.get(r,"$tb").attr(e,...t),Reflect.get(r,"$proxy"))}},bi={get:function(r,e){let t=Reflect.get(r,e);return t!==void 0?t:nt(e)}};function nt(r){let e=new wi(r),t,i=function(){return e.append(...arguments),t};return i.$tb=e,i.$node=e.$node,t=new Proxy(i,$i),i.$proxy=t,t}nt.html=Rt;nt.encode=Xe;let I=new Proxy(nt,bi);class Ni extends di{constructor(){super(),this.browser=!0,this.document=document,this.window=window,this.hydrateMounts=document.head.querySelector("meta[name='co-ssr']")?[]:null,this.pendingStyles=""}declareStyle(e){e.length>0&&(this.pendingStyles+=`
`+e,this.hydrateMounts||this.window.requestAnimationFrame(()=>this.mountStyles()))}mountStyles(){this.pendingStyles.length!=0&&(this.styleNode||(this.styleNode=document.createElement("style")),this.styleNode.innerHTML+=this.pendingStyles+`
`,this.pendingStyles="",this.styleNode.parentNode||document.head.appendChild(this.styleNode))}doHydrate(){it(async()=>{for(;await this.untilLoaded(),fi();)await new Promise(e=>Lt(e));Lt(()=>{document.querySelectorAll(".cossr").forEach(t=>t.remove());let e=this.hydrateMounts;this.hydrateMounts=null,e.forEach(t=>{Mt(t.el),this.mount(t.component,t.el)}),Mt(document.head),this.mountStyles()})},Number.MAX_SAFE_INTEGER)}mount(e,t){typeof t=="string"&&(t=document.querySelector(t)),this.hydrateMounts?(this.hydrateMounts.push({el:t,component:e}),this.hydrateMounts.length==1&&this.doHydrate()):(t.append(...e.rootNodes),e.setMounted(!0))}unmount(e){e.created&&e.rootNodes.forEach(t=>t.remove()),e.setMounted(!1)}async fetchTextAsset(e){let t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch '${e}': ${t.status} ${t.statusText}`);return t.text()}}if(typeof document<"u"){let r=new Ni;hi(()=>r)}function Mt(r){let e=r.firstChild,t=!1;for(;e;){let i=e.nextSibling;e.nodeType==8&&e.data=="co-ssr-start"&&(t=!0),t&&e.remove(),e.nodeType==8&&e.data=="co-ssr-end"&&(t=!1),e=i}}function xi(r){let e="^",t=r.length,i;for(let s=0;s<t;s++){i=!0;let a=r[s];if(a=="?")e+="[^\\/]";else if(a=="*")s+1==t?e+="(?<tail>.*)":e+="[^\\/]+";else if(a==":"){s++;let d=s;for(;s<t&&n(r[s]);)s++;let h=r.substring(d,s);if(h.length==0)throw new Error("syntax error in url pattern: expected id after ':'");let p="[^\\/]+";if(r[s]=="("){s++,d=s;let f=0;for(;s<t;){if(r[s]=="(")f++;else if(r[s]==")"){if(f==0)break;f--}s++}if(s>=t)throw new Error("syntax error in url pattern: expected ')'");p=r.substring(d,s),s++}if(s<t&&r[s]=="*"||r[s]=="+"){let f=r[s];s++,r[s]=="/"?(e+=`(?<${h}>(?:${p}\\/)${f})`,s++):f=="*"?e+=`(?<${h}>(?:${p}\\/)*(?:${p})?\\/?)`:e+=`(?<${h}>(?:${p}\\/)*(?:${p})\\/?)`,i=!1}else e+=`(?<${h}>${p})`;s--}else a=="/"?(e+="\\"+a,s==r.length-1&&(e+="?")):".$^{}[]()|*+?\\/".indexOf(a)>=0?(e+="\\"+a,i=a!="/"):e+=a}return i&&(e+="\\/?"),e+="$",e;function n(s){return s>="a"&&s<="z"||s>="A"&&s<="Z"||s>="0"&&s<="9"||s=="_"||s=="$"}}class Ct{static get(){if(coenv.browser)return{top:coenv.window.pageYOffset||coenv.document.documentElement.scrollTop,left:coenv.window.pageXOffset||coenv.document.documentElement.scrollLeft}}static set(e){coenv.browser&&(e?coenv.window.scrollTo(e.left,e.top):coenv.window.scrollTo(0,0))}}var Q,G;class Ei{constructor(e){w(this,Q);w(this,G,{});m(this,Q,e),coenv.window.history.scrollRestoration&&(coenv.window.history.scrollRestoration="manual");let t=coenv.window.sessionStorage.getItem("codeonly-view-states");t&&m(this,G,JSON.parse(t)),e.addEventListener("mayLeave",(i,n)=>(this.captureViewState(),!0)),e.addEventListener("mayEnter",(i,n)=>{n.navMode!="push"&&(n.viewState=o(this,G)[n.state.sequence])}),e.addEventListener("didEnter",(i,n)=>{if(n.navMode=="push"){for(let s of Object.keys(o(this,G)))parseInt(s)>n.state.sequence&&delete o(this,G)[s];this.saveViewStates()}Dt(coenv,()=>{it(()=>{var s,a;if(n.handler.restoreViewState?n.handler.restoreViewState(n.viewState,n):o(this,Q).restoreViewState?(a=(s=o(this,Q)).restoreViewState)==null||a.call(s,n.viewState,n):Ct.set(n.viewState),coenv.browser){let d=document.getElementById(n.url.hash.substring(1));d==null||d.scrollIntoView()}})})}),coenv.window.addEventListener("beforeunload",i=>{this.captureViewState()})}captureViewState(){var t,i;let e=o(this,Q).current;e&&(e.handler.captureViewState?o(this,G)[e.state.sequence]=e.handler.captureViewState(e):o(this,Q).captureViewState?o(this,G)[e.state.sequence]=(i=(t=o(this,Q)).captureViewState)==null?void 0:i.call(t,e):o(this,G)[e.state.sequence]=Ct.get()),this.saveViewStates()}saveViewStates(){coenv.window.sessionStorage.setItem("codeonly-view-states",JSON.stringify(o(this,G)))}}Q=new WeakMap,G=new WeakMap;var Fe,q,Be;class Si{constructor(){w(this,Fe,0);w(this,q);w(this,Be,!1)}async start(e){m(this,q,e),new Ei(e),coenv.document.body.addEventListener("click",s=>{if(s.defaultPrevented)return;let a=s.target.closest("a");if(a){if(a.hasAttribute("download"))return;let d=a.getAttribute("href"),h=new URL(d,coenv.window.location);if(h.origin==coenv.window.location.origin){try{h=o(this,q).internalize(h)}catch{return}return this.navigate(h).then(p=>{p==null&&(window.location.href=d)}),s.preventDefault(),!0}}}),coenv.window.addEventListener("popstate",async s=>{if(o(this,Be)){m(this,Be,!1);return}let a=o(this,Fe)+1,d=o(this,q).internalize(new URL(coenv.window.location)),h=s.state??{sequence:this.current.state.sequence+1};await this.load(d,h,{navMode:"pop"})||a==o(this,Fe)&&(m(this,Be,!0),coenv.window.history.go(this.current.state.sequence-h.sequence))});let t=o(this,q).internalize(new URL(coenv.window.location)),i=coenv.window.history.state??{sequence:0},n=await this.load(t,i,{navMode:"start"});return coenv.window.history.replaceState(i,null),n}get current(){return o(this,q).current}async load(e,t,i){return Se(this,Fe)._++,await o(this,q).load(e,t,i)}back(){if(this.current.state.sequence==0){let e=new URL("/",o(this,q).internalize(new URL(coenv.window.location))),t={sequence:0};coenv.window.history.replaceState(t,"",o(this,q).externalize(e)),this.load(e,t,{navMode:"replace"})}else coenv.window.history.back()}replace(e){typeof e=="string"&&(e=new URL(e,o(this,q).internalize(new URL(coenv.window.location)))),e!==void 0&&(this.current.pathname=e.pathname,this.current.url=e,e=o(this,q).externalize(e).href),coenv.window.history.replaceState(this.current.state,"",e)}async navigate(e){typeof e=="string"&&(e=new URL(e,o(this,q).internalize(new URL(coenv.window.location))));let t=await this.load(e,{sequence:this.current.state.sequence+1},{navMode:"push"});return t&&(coenv.window.history.pushState(t.state,"",o(this,q).externalize(e)),t)}}Fe=new WeakMap,q=new WeakMap,Be=new WeakMap;var xe,b,wt,et,_e,H,zt,ye,Ye,qe,de,Pe;class Li{constructor(e){w(this,b);F(this,"urlMapper");w(this,xe);F(this,"urlMapper");w(this,et,{c:null,p:null,l:[]});w(this,de,[]);w(this,Pe,!1);F(this,"captureViewState");F(this,"restoreViewState");e&&this.register(e)}start(e){if(!o(this,xe))return e||(e=new Si),m(this,xe,e),e&&(this.navigate=e.navigate.bind(e),this.replace=e.replace.bind(e),this.back=e.back.bind(e)),o(this,xe).start(this)}internalize(e){return M(this,b,wt).call(this,e,"internalize")}externalize(e){return M(this,b,wt).call(this,e,"externalize")}get current(){return o(this,b,H)}get pending(){return o(this,b,ye)}addEventListener(e,t){o(this,b,qe).push({event:e,handler:t})}removeEventListener(e,t){let i=o(this,b,qe).findIndex(n=>n.event==e&&n.handler==t);i>=0&&o(this,b,qe).splice(i,1)}async dispatchEvent(e,t,i,n){for(let s of o(this,b,qe))if(s.event==e){let a=s.handler(i,n);if(t&&await Promise.resolve(a)==!1)return!1}return!0}async load(e,t,i){return coenv.load(async()=>{var s,a,d;i=i??{};let n=o(this,b,H);if(((s=o(this,b,H))==null?void 0:s.url.pathname)==e.pathname&&o(this,b,H).url.search==e.search){let h=(d=(a=o(this,b,H).handler).hashChange)==null?void 0:d.call(a,o(this,b,H),i);h!==void 0?i=h:i=Object.assign({},o(this,b,H),i)}if(i=Object.assign(i,{current:!1,url:new URL(e),state:t}),m(this,b,i,Ye),!i.match&&(i=await this.matchUrl(e,t,i),!i))return null;try{await this.tryLoad(i)!==!0&&m(this,b,null,Ye)}catch(h){throw this.dispatchCancelEvents(n,i),h}return o(this,b,ye)!=i?(this.dispatchCancelEvents(n,i),null):(m(this,b,null,Ye),i)})}dispatchCancelEvents(e,t){var i,n,s,a,d;(s=(i=o(this,b,H))==null?void 0:(n=i.handler).cancelLeave)==null||s.call(n,e,t),(d=(a=t.handler).cancelEnter)==null||d.call(a,e,t),this.dispatchEvent("cancel",!1,e,t)}async tryLoad(e){var n,s,a,d,h,p,f,u;let t=o(this,b,H),i;if(!(t&&(!await this.dispatchEvent("mayLeave",!0,t,e)||e!=o(this,b,ye)||(i=(s=(n=t.handler).mayLeave)==null?void 0:s.call(n,t,e),await Promise.resolve(i)===!1)||e!=o(this,b,ye)))&&(i=(d=(a=e.handler).mayEnter)==null?void 0:d.call(a,t,e),await Promise.resolve(i)!==!1&&e==o(this,b,ye)&&await this.dispatchEvent("mayEnter",!0,t,e)&&e==o(this,b,ye)))return t&&(t.current=!1),e.current=!0,m(this,b,e,zt),t&&(this.dispatchEvent("didLeave",!1,t,e),(p=t==null?void 0:(h=t.handler).didLeave)==null||p.call(h,t,e)),(u=(f=e.handler).didEnter)==null||u.call(f,t,e),this.dispatchEvent("didEnter",!1,t,e),!0}async matchUrl(e,t,i){o(this,Pe)&&(o(this,de).sort((n,s)=>(n.order??0)-(s.order??0)),m(this,Pe,!1));for(let n of o(this,de))if(!(n.pattern&&(i.match=i.url.pathname.match(n.pattern),!i.match)))if(n.match){let s=await Promise.resolve(n.match(i));if(s===!0||s==i)return i.handler=n,i;if(s===null)return null}else return i.handler=n,i;return i.handler={},i}register(e){Array.isArray(e)||(e=[e]);for(let t of e)typeof t.pattern=="string"&&(t.pattern=new RegExp(xi(t.pattern))),o(this,de).push(t);m(this,Pe,!0)}revoke(e){m(this,de,o(this,de).filter(t=>!e(t)))}}xe=new WeakMap,b=new WeakSet,wt=function(e,t){return this.urlMapper?e instanceof URL?this.urlMapper[t](e):this.urlMapper[t](new URL(e,"http://x/")).href.substring(8):e instanceof URL?new URL(e):e},et=new WeakMap,_e=function(){var e;return((e=o(this,xe))==null?void 0:e.state)??o(this,et)},H=function(){return o(this,b,_e).c},zt=function(e){o(this,b,_e).c=e},ye=function(){return o(this,b,_e).p},Ye=function(e){o(this,b,_e).p=e},qe=function(){return o(this,b,_e).l},de=new WeakMap,Pe=new WeakMap;let he=new Li,Ae={appName:"MiniList",description:"MiniList CodeOnly Project"};class Ut extends te{constructor(){super(),he.addEventListener("didEnter",(e,t)=>{this.invalidate(),coenv.browser&&(document.title=this.title)})}get title(){var e;return(e=he.current)!=null&&e.title?`${he.current.title} - ${Ae.appName}`:Ae.appName}get name(){return Ae.appName}get description(){return Ae.description}get url(){var e;return((e=he.current)==null?void 0:e.url.href)??""}get image(){return null}}F(Ut,"template",[I.title(e=>e.title),I.meta.name("description").content(e=>e.description),I.meta.itemprop("name").content(e=>e.name),I.meta.itemprop("description").content(e=>e.description),I.meta.itemprop("image").content(e=>e.image).if(e=>e.image),I.meta.name("og:url").content(e=>e.url),I.meta.name("og:type").content("website"),I.meta.name("og:title").content(e=>e.title),I.meta.name("og:description").content(e=>e.description),I.meta.name("og:image").content(e=>e.image).if(e=>e.image),I.meta.name("twitter:card").content("summary_large_image"),I.meta.name("twitter:title").content(e=>e.title),I.meta.name("twitter:description").content(e=>e.description),I.meta.name("twitter:image").content(e=>e.image).if(e=>e.image),I.link.rel("apple-touch-icon").href(e=>e.image).if(e=>e.image)]);class Wt extends te{}F(Wt,"template",{type:"header #header",$:[{type:"a .title",href:"/",$:[{type:"img",src:"/public/logo.svg"},Ae.appName]},{type:"div .buttons",$:[{type:"input type=checkbox .theme-switch",on_click:()=>window.stylish.toggleTheme()},{type:"script",text:Rt('document.querySelector(".theme-switch").checked = window.stylish.darkMode;')}]}]});Oe`
:root
{
    --header-height: 50px;
}

#header
{
    position: fixed;
    top: 0;
    width: 100%;
    height: var(--header-height);

    display: flex;
    justify-content: start;
    align-items: center;
    border-bottom: 1px solid var(--gridline-color);
    padding-left: 10px;
    padding-right: 10px;
    background-color: rgb(from var(--back-color) r g b / 75%);
    z-index: 1;

    .title 
    {
        flex-grow: 1;
        display: flex;
        align-items: center;
        color: var(--body-fore-color);
        transition: opacity 0.2s;

        &:hover
        {
            opacity: 75%;
        }

        img
        {
            height: calc(var(--header-height) - 25px);
            padding-right: 10px
        }
    }


    .buttons
    {
        font-size: 12pt;
        display: flex;
        gap: 10px;
        align-items: center;

        .theme-switch
        {
            transform: translateY(-1.5px);
        }
    }
}
`;class _i extends te{showModal(){document.body.appendChild(this.domTree.rootNode),this.domTree.rootNode.showModal(),this.domTree.rootNode.addEventListener("close",()=>{this.domTree.rootNode.remove()})}static onProvideTemplate(){return{type:"dialog",class:"dialog",id:this.template.id,$:{type:"form",method:"dialog",$:[{type:"header",$:this.template.title},{type:"main",$:this.template.content},{type:"footer",$:this.template.footer}]}}}}Oe`
dialog.dialog
{
    position: fixed;
    left: 0;
    top: 0;
    width: 100vw;
    height: 100vh;
    max-width: 100vw;
    max-height: 100vh;
    padding: 0;
    margin: 0;
    border: none;
    border-radius: 0;
    header
    {
        padding: 10px;
    }
}
`;class Jt extends _i{}F(Jt,"template",{title:"New List",id:"new-list-dialog",content:{type:"input type=text"},footer:[{type:"button",$:"Create",class:"accent"},{type:"button",$:"Cancel"}]});Oe`
#new-list-dialog
{
    input[type=text]
    {
        border: none;
        width: 100%;
        box-shadow: none;
    }
    button
    {
        display: inline-block;
        width: 120px;
    }
}
`;class jt extends te{onNewList(){new Jt().showModal()}}F(jt,"template",{type:"footer #footer",$:[{type:"div .buttons-left",$:[{type:"button",$:"Edit"}]},{type:"div .buttons-right",$:[{type:"button",$:"New List",on_click:"onNewList"}]}]});Oe`
:root
{
    --footer-height: 50px;
}

#footer
{
    position: fixed;
    bottom: 0;
    width: 100%;
    height: var(--footer-height);

    display: flex;
    justify-content: start;
    align-items: center;
    border-top: 1px solid var(--gridline-color);
    padding-left: 10px;
    padding-right: 10px;
    background-color: rgb(from var(--back-color) r g b / 75%);
    z-index: 1;

    .buttons-left
    {
        flex-grow: 1;
        font-size: 12pt;
        display: flex;
        gap: 10px;
        align-items: center;
    }
    .buttons-right
    {
        font-size: 12pt;
        display: flex;
        gap: 10px;
        align-items: center;
    }

}
`;const tt=class tt extends te{constructor(){super(),this.items=[{name:"Groceries",items:[{name:"Apples",checked:!1},{name:"Pears",checked:!1},{name:"Bananas",checked:!0}]},{name:"Cantabile",items:[]},{name:"This Week",items:[]}]}static format_counts(e){let t=e.items.filter(i=>i.checked).length;return t?`${e.items.length-t} of ${e.items.length} remaining`:`${e.items.length} items`}};F(tt,"template",[Wt,{type:"main",$:{foreach:{items:e=>e.items},type:"div",class:"list-item",$:[{type:"h3",$:e=>e.name},{type:"div",class:"counts",$:e=>tt.format_counts(e)}]}},jt]);let $t=tt;Oe`
main
{
    padding-top: var(--header-height);
    padding-bottom: var(--footer-height);

    .list-item
    {
        padding: 5px;
        user-select: none; 

        h3 
        { 
            margin: 0; 
            padding: 0;
            font-size: 1rem;
            color: var(--accent-color);
        }
        
        .counts
        {
        }

        border-bottom: 1px solid var(--gridline-color);
    }
}
`;he.register({pattern:"/",match:r=>(r.page=new $t,!0)});class Gt extends te{constructor(e){super(),this.url=e}}F(Gt,"template",{type:"div",class:"center",$:[{type:"h1",class:"danger",text:"Page not found! "},{type:"p",text:e=>`The page ${e.url} doesn't exist!`},{type:"p",$:{type:"a",href:"/",text:"Return Home"}}]});he.register({match:r=>(r.page=new Gt(r.url),!0),order:1e3});class Ht extends te{constructor(){super(),this.page=null,he.addEventListener("didEnter",(e,t)=>{t.page&&(this.page=t.page,this.invalidate())})}}F(Ht,"template",{type:"embed-slot",content:e=>e.page});Oe`
`;function Ti(){new Ut().mount("head"),new Ht().mount("body"),he.start()}Ti();
